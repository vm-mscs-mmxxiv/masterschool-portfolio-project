<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Network Topology - Masterschool Final Project</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././theme/css/custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Masterschool Final Project</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="network-topology"><a class="header" href="#network-topology">Network Topology</a></h1>
<h2 id="-your-revised-network-layout"><a class="header" href="#-your-revised-network-layout">‚úÖ Your Revised Network Layout</a></h2>
<pre><code class="language-bash">[ Host Machine ]
      |
   (NAT to real Internet)   &lt;-- QEMU user-mode net, ON only during setup/updates
      |
+---------------------+
| Gateway / Proxy VM  |  &lt;-- Acts as:
| - NAT to Internet   |     ‚Ä¢ Internet access during setup
| - Router/Switch     |     ‚Ä¢ Simulated WAN for lab
+-----+---------+-----+
      |         |
      |         +-- [ Attacker VM ] &lt;-- Lives in simulated WAN
      |
(Internal WAN/Lab Bridge)
      |
[ Firewall VM ]  &lt;-- WAN NIC connected to Internal WAN/Lab Bridge
      |
 (LAN Switch inside Firewall VM, or separate bridge for LAN)
      |
-----------------------------------------
    |        |           |          |     
|Dept1   |Dept2   |Dept3     |SOC/Admin VM|
|Finance |HR      |Developers|            |
</code></pre>
<hr />
<p>üîÑ Next Questions to Think About
What VM tool do you use to wire networking? QEMU bridges + tap? virt-manager? custom script?
Do you want to simulate Internet access (with NAT)?
Do you want to test IDS/IPS tools (e.g., Suricata)?
Do you want VLANs to be real (802.1Q) or simulated (software separated)?
Will you monitor from the host (Wireshark, etc.)?</p>
<p>Excellent direction ‚Äî you‚Äôre clearly aligning this with <strong>realistic enterprise-like network segmentation</strong>, which is the right way to go. Let's refine the plan based on your remarks and add some structured suggestions.</p>
<hr />
<h2 id="-updated-vm-use-cases--recommendations"><a class="header" href="#-updated-vm-use-cases--recommendations">üîç Updated VM Use Cases + Recommendations</a></h2>
<h3 id="-1-attacker-machine"><a class="header" href="#-1-attacker-machine">üß® <strong>1. Attacker Machine</strong></a></h3>
<ul>
<li>
<p>‚úÖ <strong>Use case</strong>: Simulate <em>external threat actor</em>.</p>
</li>
<li>
<p>‚úÖ <strong>VM</strong>: Kali Linux with XFCE (GUI tools like Burp, Metasploit, etc.).</p>
</li>
<li>
<p>‚úÖ <strong>Network</strong>: Should be <strong>outside of the internal LAN</strong>.</p>
<ul>
<li>Put on a separate virtual <strong>bridge</strong> (e.g., <code>br-attack</code>).</li>
<li>This bridge should connect to the <strong>external interface</strong> of the firewall/router VM.</li>
</ul>
</li>
</ul>
<p><strong>‚úÖ Realism Check:</strong> ‚úîÔ∏è This models how real attacks happen ‚Äî from external Internet or unknown zones.</p>
<hr />
<h3 id="-2-admin--soc-machine-debian--xfce"><a class="header" href="#-2-admin--soc-machine-debian--xfce">üë®‚Äçüíª <strong>2. Admin + SOC Machine (Debian + XFCE)</strong></a></h3>
<ul>
<li>
<p>‚úÖ <strong>Use case</strong>: Secure VM for <strong>managing</strong> the lab and <strong>monitoring</strong> it.</p>
</li>
<li>
<p>‚úÖ <strong>Tools</strong>:</p>
<ul>
<li>SSH keys for admin tasks</li>
<li>Ansible for automation</li>
<li>Splunk/Syslog/SOC tools (Falco, Wazuh, etc.)</li>
</ul>
</li>
<li>
<p>üß© <strong>Suggestion</strong>:</p>
<ul>
<li>Use <strong>separate user accounts</strong> for <code>admin</code> and <code>soc</code>.</li>
<li>Or if you're comfortable: use 2 VMs for cleaner isolation, but resource cost increases.</li>
</ul>
</li>
<li>
<p>‚úÖ <strong>Location</strong>: Place it in a <strong>management VLAN</strong>, only reachable through firewall.</p>
</li>
</ul>
<hr />
<h3 id="-3-firewall-vm"><a class="header" href="#-3-firewall-vm">üî• <strong>3. Firewall VM</strong></a></h3>
<ul>
<li>
<p>‚úÖ <strong>Use case</strong>: Route + filter all inter-segment traffic.</p>
</li>
<li>
<p>‚úÖ <strong>Distro</strong>: <strong>Alpine</strong> is a strong choice ‚Äî lightweight, hardened, reliable.</p>
</li>
<li>
<p>‚úÖ <strong>Network Setup</strong>:</p>
<ul>
<li><code>eth0</code>: connected to attacker net (<code>br-attack</code>)</li>
<li><code>eth1</code>: connected to internal LAN (<code>br-int</code>)</li>
<li>Optional <code>eth2</code>: management interface to admin VM</li>
</ul>
</li>
</ul>
<p><strong>Tools</strong>:</p>
<ul>
<li>Use <code>nftables</code> or <code>iptables</code> (or both if Alpine has legacy support).</li>
<li>Install <strong>Suricata or Snort</strong> here. See next section.</li>
</ul>
<hr />
<h3 id="-4-idsips-choice-suricata-vs-snort"><a class="header" href="#-4-idsips-choice-suricata-vs-snort">üß™ <strong>4. IDS/IPS Choice: Suricata vs. Snort</strong></a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th><strong>Suricata</strong></th><th><strong>Snort</strong></th></tr></thead><tbody>
<tr><td>License</td><td>GPLv2</td><td>GPLv2</td></tr>
<tr><td>Multithread</td><td>‚úÖ Yes</td><td>‚ùå No</td></tr>
<tr><td>Protocols</td><td>Layer 7 DPI</td><td>Mainly Layer 3/4</td></tr>
<tr><td>Performance</td><td>Fast, modern</td><td>Legacy-style</td></tr>
<tr><td>Output</td><td>JSON, EVE</td><td>Unified2</td></tr>
</tbody></table>
</div>
<p>‚úÖ <strong>Recommendation</strong>: Use <strong>Suricata</strong> ‚Äî especially since you're familiar with it already, and it's better suited for modern traffic inspection.</p>
<p><strong>Placement</strong>: Install on <strong>firewall VM</strong> to inspect both inbound and outbound traffic.</p>
<hr />
<h3 id="-5-router-vm"><a class="header" href="#-5-router-vm">üåê <strong>5. Router VM</strong></a></h3>
<ul>
<li>
<p>‚úÖ <strong>Use case</strong>: Simulate <em>Internet access</em> or <em>inter-office routing</em>.</p>
</li>
<li>
<p>üí° Suggestion:</p>
<ul>
<li>
<p>Combine <strong>firewall + router</strong> role into <strong>one Alpine-based VM</strong>.</p>
</li>
<li>
<p>NAT + DNS forwarding + DHCP server for lab subnets.</p>
</li>
<li>
<p>You can create <strong>3 NICs</strong>:</p>
<ul>
<li><code>eth0</code>: <em>external network (attacker/Internet simulation)</em></li>
<li><code>eth1</code>: <em>internal lab subnet</em></li>
<li><code>eth2</code>: <em>optional management interface</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h3 id="-6-departmental-vms-5x"><a class="header" href="#-6-departmental-vms-5x">üñ•Ô∏è <strong>6. Departmental VMs (5x)</strong></a></h3>
<ul>
<li>
<p>‚úÖ <strong>Use case</strong>: Employees in various departments.</p>
</li>
<li>
<p>Examples:</p>
<ul>
<li>HR</li>
<li>Dev</li>
<li>Finance</li>
<li>Sales</li>
<li>R&amp;D</li>
</ul>
</li>
<li>
<p>üí° Suggestion: Assign <strong>separate VLAN/subnet</strong> to each.</p>
</li>
<li>
<p>‚úÖ Harden them differently depending on risk level.</p>
</li>
<li>
<p>Use <strong>Ansible</strong> for initial provisioning.</p>
</li>
<li>
<p>Add <strong>logging agents</strong> (rsyslog, Filebeat, etc.) to forward logs to SOC.</p>
</li>
</ul>
<hr />
<h3 id="-suggested-additions"><a class="header" href="#-suggested-additions">üß† Suggested Additions</a></h3>
<h4 id="-pki--vault"><a class="header" href="#-pki--vault">üîê PKI &amp; Vault</a></h4>
<ul>
<li>
<p>Set up <strong>GPG or age-encrypted password vault</strong> for managing:</p>
<ul>
<li>Admin SSH keys</li>
<li>Preseed passwords</li>
<li>Ansible vault secrets</li>
</ul>
</li>
<li>
<p>Optionally: use <code>pass</code> + GPG or <code>ansible-vault</code>.</p>
</li>
</ul>
<h4 id="-dhcpdns"><a class="header" href="#-dhcpdns">üõú DHCP/DNS</a></h4>
<ul>
<li>
<p>Decide who will provide these:</p>
<ul>
<li>Alpine firewall?</li>
<li>Or separate ISC DHCP + unbound DNS?</li>
</ul>
</li>
</ul>
<h4 id="-monitoring"><a class="header" href="#-monitoring">üì° Monitoring</a></h4>
<ul>
<li>Consider adding a <strong>monitoring VM</strong> (Prometheus/Grafana/Netdata).</li>
<li>Tap internal traffic (e.g., use a port mirror bridge if supported).</li>
</ul>
<h2 id="-what-you-can-work-on-next"><a class="header" href="#-what-you-can-work-on-next">üîß What You Can Work on Next</a></h2>
<ol>
<li>
<p><strong>Bridge creation</strong> in QEMU for <code>br-int</code>, <code>br-attack</code>, <code>br-mgmt</code>.</p>
</li>
<li>
<p>Setup <strong>Alpine firewall/router</strong> with:</p>
<ul>
<li>NAT</li>
<li>Routing</li>
<li>Suricata</li>
<li>Static IPs for VMs</li>
</ul>
</li>
<li>
<p>Define <strong>subnets</strong>:</p>
<ul>
<li>e.g. <code>192.168.10.0/24</code> for internal</li>
<li><code>192.168.20.0/24</code> for mgmt</li>
<li><code>192.168.99.0/24</code> for attacker net</li>
</ul>
</li>
<li>
<p>Start writing <strong>QEMU scripts</strong> to launch each VM and attach to proper bridges.</p>
</li>
</ol>
<hr />
<p>Would you like help creating bridge setup + QEMU launch scripts + Suricata config for Alpine next?</p>
<ol start="2">
<li>
<p>Temporary internet via NAT for setup only
For quick package installation:
Temporarily attach a VM to a QEMU NAT network for updates.
Disconnect it after updates are done and reconnect to lab LAN.
This avoids having a permanent internet path in the lab.</p>
</li>
<li>
<p>Host OS
Runs QEMU and your VMs.
Not part of the lab network (isolated).</p>
</li>
<li>
<p>Firewall VM (Alpine, 2+ NICs)
WAN NIC ‚Üí Connected to a QEMU NAT network (this simulates the "internet" in your lab).
This is where updates and external tools can be downloaded.
In your simulation, the attacker's side connects here.
LAN NIC(s) ‚Üí Connected to lab bridges (br0, br1, etc.).
These are your "company networks" with VLANs inside.
The firewall:
Acts as border firewall for your company network.
Routes traffic between attacker and company LAN.
Can apply NAT, ACLs, firewall rules (nftables/iptables).</p>
</li>
<li>
<p>Attacker VM
Connected to the WAN side of the Firewall VM.
This makes the attacker ‚Äúoutside‚Äù the company, just like an internet-based attacker.
Must break through firewall to reach inside network.</p>
</li>
<li>
<p>Bridges
On the LAN side of the firewall you can have one or more bridges:
Example: br0 with VLAN 10 (Finance) and VLAN 20 (HR).
Example: br1 with VLAN 30 (SOC/Admin).
Bridges simulate network switches, VLANs simulate segmentation.</p>
</li>
<li>
<p>Realism in simulation
In the real world, an attacker doesn't ‚Äúfind‚Äù the firewall ‚Äî they just know they are outside, and the firewall is the company‚Äôs border with the internet.
Your WAN-side bridge (with attacker) is the simulated internet.
Your firewall‚Äôs LAN side is the protected internal company network.</p>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../project/initial-suggestions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../setup/setup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../project/initial-suggestions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../setup/setup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
